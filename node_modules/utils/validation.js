import { db } from '../../src/db/index.js';


export const validateEmail = (email) => {
    const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    return regex.test(email);
};

export const validatePassword = (password) => {
    const regex = /^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-zA-Z]).{6,}$/;
    return regex.test(password);
};

export const validateUsername = (first_name, last_name) => {
    const regex1 = /^[a-zA-Z]{3,}$/;
    const regex2 = /^[a-zA-Z]{4,}$/;
    return regex1.test(first_name) && regex2.test(last_name);
};

export const checkEmailExists = async (email) => {
    try {
        const [rows] = await db.query('SELECT * FROM users WHERE email = ?', [email]);
        return rows.length > 0;
    } catch (err) {
        console.error('Error checking email:', err);
        throw err;
    }
};

// Check if username exists
export const checkUsernameExists = async (first_name, last_name) => {
    try {
        const [rows] = await db.query('SELECT * FROM users WHERE first_name = ? AND last_name = ?', [first_name, last_name]);
        return rows.length > 0;
    } catch (err) {
        console.error('Error checking username:', err);
        throw err;
    }
};